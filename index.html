<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvoSpeech</title>
    <style>
        /* Your same CSS here (keep as is)... */
        body { background-color: #f5f5f7; font-family: sans-serif; margin: 0; padding: 0; }
        .header { display: flex; justify-content: space-between; padding: 20px; }
        .logo { font-size: 2rem; font-weight: bold; }
        .logo span:first-child { color: #2962ff; }
        .logo span:last-child { color: #000; }
        .text-container { margin: 20px; font-size: 1.2rem; color: #333; min-height: 150px; }
        .record-btn { width: 80px; height: 80px; margin: 20px auto; border-radius: 50%; background: linear-gradient(135deg, #2962ff, #0091ea); display: flex; justify-content: center; align-items: center; color: white; cursor: pointer; font-size: 1.2rem; }
        .visualizer { display: flex; justify-content: center; margin-top: 20px; gap: 5px; }
        .bar { width: 8px; background-color: #2962ff; border-radius: 3px; height: 20px; transition: height 0.2s; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo">
            <span>Evo</span><span>Speech</span>
        </div>
        <img src="seticon.png" alt="Settings" class="settings-icon" style="width: 30px;">
    </div>

    <div class="text-container" id="transcription">
        Start recording... your text will appear here.
    </div>

    <div class="visualizer" id="visualizer">
        <!-- 20 bars -->
    </div>

    <div class="record-btn" id="recordBtn">Start</div>

    <script>
        const recordBtn = document.getElementById('recordBtn');
        const transcription = document.getElementById('transcription');
        const visualizer = document.getElementById('visualizer');

        let recognition;
        let isRecording = false;

        // Initialize Speech Recognition if available
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US'; // Change if needed

            recognition.onstart = () => {
                isRecording = true;
                recordBtn.textContent = 'Stop';
                transcription.style.color = '#2962ff';
                startVisualizer();
            };

            recognition.onresult = (event) => {
                let finalTranscript = '';
                for (let i = event.resultIndex; i < event.results.length; ++i) {
                    finalTranscript += event.results[i][0].transcript;
                }
                transcription.textContent = finalTranscript || 'Listening...';
            };

            recognition.onerror = (event) => {
                console.error('Recognition error:', event.error);
                transcription.textContent = 'Error occurred: ' + event.error;
                stopRecording();
            };

            recognition.onend = () => {
                if (isRecording) {
                    recognition.start(); // Restart if recording was manually stopped
                } else {
                    stopRecording();
                }
            };

        } else {
            // Not supported
            alert('Speech Recognition not supported in this browser.');
            recordBtn.disabled = true;
        }

        // Toggle recording
        recordBtn.addEventListener('click', () => {
            if (!isRecording) {
                if (recognition) recognition.start();
            } else {
                if (recognition) recognition.stop();
                stopRecording();
            }
        });

        // Visualizer setup
        for (let i = 0; i < 20; i++) {
            const bar = document.createElement('div');
            bar.classList.add('bar');
            visualizer.appendChild(bar);
        }

        function startVisualizer() {
            const bars = visualizer.querySelectorAll('.bar');
            function animate() {
                if (!isRecording) return;
                bars.forEach(bar => {
                    bar.style.height = `${Math.random() * 50 + 10}px`;
                });
                requestAnimationFrame(animate);
            }
            animate();
        }

        function stopRecording() {
            isRecording = false;
            recordBtn.textContent = 'Start';
            transcription.style.color = '#333';
        }
    </script>
</body>
</html>
